---
title: "merged data"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(BiocManager)
BiocManager::install("GEOquery")
library(GEOquery) 
library(tidyverse)
library(limma)
BiocManager::install("oligo")
library(oligo)
library(magrittr)
library(curl)
```


```{r}
# get supplementary files
# Download the file manually from GEO
download.file("https://ftp.ncbi.nlm.nih.gov/geo/series/GSE42nnn/GSE42127/matrix/GSE42127_series_matrix.txt.gz",
              destfile = "GSE42127_series_matrix.txt.gz")

# Load the file
#gse42127 <- getGEO(filename = "GSE42127_series_matrix.txt.gz")

gse42127 = getGEO("GSE42127", GSEMatrix = T)

#expression data
gse42127.expr = exprs(gse42127[[1]])

#background correction
gse42127_corrected = backgroundCorrect.matrix(gse42127.expr, method = "normexp")

#normalization
gse42127.normalized = normalizeBetweenArrays(gse42127_corrected, method = "quantile")

hist(gse42127.expr)
hist(gse42127_corrected)
hist(gse42127.normalized)
```

#RESEARCH BACKGROUND CORRECTION FOR ILLUMINA FILE..RMA IS AFFYM



